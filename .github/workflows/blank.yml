name: Call WorkFlow

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  repository_dispatch:
    types: [trigger-maven-build]
  workflow_dispatch:

jobs:
  trigger_build:
    runs-on: ubuntu-latest
    steps:
      - name: Trigger Java CI workflow in another repository
        id: trigger-java-ci
        uses: peter-evans/repository-dispatch@v1
        with:
          token: ${{ secrets.PAT }}
          repository: souravdasbitm/JavaSeleniumRestAssured
          event-type: trigger-maven-build

      - name: Get status of triggered workflow
        id: get-status
        uses: actions/github-script@v4
        with:
          github-token: ${{ secrets.PAT }}
          script: |
            const response = await github.actions.getWorkflowRun({
              owner: 'souravdasbitm', // Replace with the owner of the repository
              repo: 'JavaSeleniumRestAssured',
              run_id: ${{ steps.trigger-java-ci.outputs.run_id }}
            });
            console.log(response.data.status);
